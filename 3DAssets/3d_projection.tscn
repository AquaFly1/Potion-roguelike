[gd_scene load_steps=8 format=3 uid="uid://drhlo4inut523"]

[ext_resource type="PackedScene" uid="uid://pujqkmtdknev" path="res://3DAssets/3DEnvironment.tscn" id="2_v6xcv"]
[ext_resource type="Shader" uid="uid://b4ho85s3kdodg" path="res://Shaders/3DMask.gdshader" id="3_b7dpg"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_b7dpg"]
shader = ExtResource("3_b7dpg")
shader_parameter/key_color = Color(1, 0, 1, 1)
shader_parameter/threshold = 0.3
shader_parameter/softness = 0.1

[sub_resource type="ViewportTexture" id="ViewportTexture_v6xcv"]
viewport_path = NodePath("3D View/ViewMasked")

[sub_resource type="ViewportTexture" id="ViewportTexture_b7dpg"]
viewport_path = NodePath("3D View/ViewBack")

[sub_resource type="PlaneMesh" id="PlaneMesh_v6xcv"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_b7dpg"]
render_priority = 1
transparency = 1
shading_mode = 0
albedo_color = Color(1, 0, 1, 1)

[node name="3D Projection" type="Sprite2D"]
z_index = -10
texture_filter = 1
material = SubResource("ShaderMaterial_b7dpg")
scale = Vector2(6, 6)
texture = SubResource("ViewportTexture_v6xcv")
centered = false

[node name="Sprite2D" type="Sprite2D" parent="."]
z_index = -50
texture_filter = 1
texture = SubResource("ViewportTexture_b7dpg")
centered = false

[node name="3D View" type="Node3D" parent="."]

[node name="ViewMasked" type="SubViewport" parent="3D View"]
transparent_bg = true
size = Vector2i(320, 180)
size_2d_override = Vector2i(1920, 1080)

[node name="3DMasked" parent="3D View/ViewMasked" instance=ExtResource("2_v6xcv")]

[node name="mask2" type="MeshInstance3D" parent="3D View/ViewMasked/3DMasked"]
transform = Transform3D(0.9937912, 0.11067823, 0.011371076, 0, 0.102202, -0.994764, -0.1112608, 0.9885877, 0.10156745, 1.55677, 1.08376, 0.7765672)
mesh = SubResource("PlaneMesh_v6xcv")
skeleton = NodePath("")
surface_material_override/0 = SubResource("StandardMaterial3D_b7dpg")

[node name="ViewBack" type="SubViewport" parent="3D View"]
transparent_bg = true
size = Vector2i(320, 180)
size_2d_override = Vector2i(1920, 1080)

[node name="3DBack" parent="3D View/ViewBack" instance=ExtResource("2_v6xcv")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 16.4911, 0, 0)
